#include<iostream>

using namespace std;

int main() {
	int pole[200][200], i, j;
	for (i = 0; i < 200; i++)
		for (j = 0; j < 200; j++)
			pole[i][j] = 0;
	for(i =87;i>=0;i--)
		for (j = 87-i; j >= 0; j--) {
			if (i + j + 1 >= 87 || i * 2 + j >= 87 || i + 2 * j >= 87)
				pole[i][j] = 1;
			else if (pole[i + 1][j] >0 && pole[i][j + 1] > 0 && pole[i * 2][j] > 0 && pole[i][j * 2] > 0)
				pole[i][j] = -max(max(pole[i + 1][j], pole[i][j + 1]), max(pole[i * 2][j], pole[i][j * 2]));
			else {
				pole[i][j] = -200;
				if (pole[i + 1][j]<0 && pole[i + 1][j]>pole[i][j]) pole[i][j] = pole[i + 1][j];
				if (pole[i][j + 1]<0 && pole[i][j + 1]>pole[i][j]) pole[i][j] = pole[i][j + 1];
				if (pole[i * 2][j]<0 && pole[i * 2][j]>pole[i][j]) pole[i][j] = pole[i * 2][j];
				if (pole[i][j * 2]<0 && pole[i][j * 2]>pole[i][j]) pole[i][j] = pole[i][j * 2];
				pole[i][j] = -pole[i][j]+1;
			}
		}
	printf("    ");
	for (i = 1; i <= 87; i++)
		printf("%3d", i);
	for (i = 87; i >= 1; i--) {
		printf("\ni:%2d", i);
		for (j = 1; j <= 87; j++)
			printf("%3d", pole[i][j]);
	}
	printf("\n    ");
	for (i = 1; i <= 75; i++)
		printf("%3d", i);
}

i:40  3 -2  2  2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:39 -3  3 -2  2 -2  2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:38  4  3  3 -2  2  3 -2  2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:37 -4  4 -3  3 -2  2  3  3 -2  2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:36  5 -4  3  4  3 -2  2 -3  3  3 -2  2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:35 -5  5  5 -4  4  3 -2  2  4 -3  3  3 -2  2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:34  6  6 -5  3 -4  4  3 -2  2  4  4 -3  3  3 -2  2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:33 -6  6  5 -5  5 -4  4  3 -2  2 -4  4  4 -3  3  3 -2  2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:32  7  7 -6  6  3  5 -4  4  3 -2  2  5 -4  4  4 -3  3  3 -2  2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:31  8 -7  6  5  6 -5  5 -4  4  3 -2  2  5  5 -4  4  4 -3  3  3 -2  2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:30 -8  8 -7  7 -6  3  6  5 -4  4  3 -2  2 -5  5  5 -4  4  4 -3  3  3 -2  2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:29  9  8  8 -7  5  7 -6  6  5 -4  4  3 -2  2  6 -5  5  5 -4  4  4 -3  3  3 -2  2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:28  9 -8  8  7  8 -7  7 -6  6  5 -4  4  3  7 -6  6  6 -5  5  5 -4  4  4 -3  3  3 -2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:27 -9  9 -9  9 -8  5 -7  7 -6  6  5 -4  4  3  7  7 -6  6  6 -5  5  5 -4  4  4 -3  3 -2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:26 10 10  6 -9  6 -5  4  8  7 -6  6  5  4 -3  2 -7  7  7 -6  6  6 -5  5  5 -4  4 -3  3  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:25-10  9 -8  8 -7  6  9 -8  8  7 -6  6  5  4 -8  8  8 -7  7  7 -6  6  6 -5  5 -4  4  3 -2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:24 11 10  9 -9  8 10 -9  9 -8  8  7  6 -5  4  9  9 -8  8  8 -7  7  7 -6  6 -5  5  4 -3  3  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:23 12-11 11 10  9-10  5 10  9 -8  8  7  5 -4  3 -9  9  9 -8  8  8 -7  7 -6  6  5 -4  4  3 -2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:22-12 12-11 10 -9  8 11-10 10  9  8 -7  6  4 -3  2 10 -9  9  9 -8  8 -7  7  6 -5  5  4 -3  3  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:21 13  2 12-11 10 12-11 11-10 10  9  7 -6  5  4 11-10 10 10 -9  9 -8  8  7 -6  6  5 -4  4  3 -2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:20-13  3-12 11-10  2  6 12 11 10 -9  8  6 -5  4-11 11 11-10 10 -9  9  8 -7  7  6 -5  5  4 -3  3  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:19 14-13 13  3 11  9  3-12 12  2  9 -8  7  5 -4  3 12-11 11-10 10  9 -8  8  7 -6  6  5 -4  4  3 -2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:18-14  5 13-12 12  3 -4  4 12-11  3  8 -7  2  4 -3  2 12-11 11 10 -9  9  8 -7  7  6 -5  5  4 -3  3  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:17 14-13  6 13  5 -5  5  3-12 11-10  4  7 -6  3  3 -2  2 12 11-10 10  9 -8  8  7 -6  6  5 -4  4  3 -2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:16-14 14  7  5 -6  6  5 -4  4  3 10 -9  5  6 -5  4  3 -3  3-11 11  2 -9  9  8 -7  7  6 -5  5  4 -3  3  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:15  9  8  8 -7  5  7 -6  5  5 -4  4  3 -6  6  6 -5  3  4 -4  4  4 -3  3  9 -8  2  7 -6  6  5 -4  4  3 -2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:14 -9  9 -8  8 -8  5  7  7 -6  5  5 -4  4 -7  6  6 -6  2  5 -5  5  4 -4  4  4 -3  3  7  2 -5  5  4 -3  3  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0
i:13 10-10  9  9  9  6  9 -8  7  7 -6  5 -4  4 -6  5  7 -7  7  6 -6  6  5 -5  5  4  4  3 -2  2  5 -4  4  3 -2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0
i:12-11 11-10 10  9  7  5  9  9 -8  7 -6  5 -4  3 -9  4  8 -8  8  7 -7  7  6  6  5 -4  4  3 -2  2  5  4 -3  3  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0
i:11 12 12 11-11 10 12-11 11-10  9 -8  7 -6  5  4 10-10  3  9 -9  9  8  8  7 -6  6  5 -4  4  3 -2  2 -4  4  3 -2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0
i:10 14-13 13 12 11  9 12-12 11-10  9 -8  7  5 -4  3 11-11  2 10 10  9 -8  8  7 -6  6  5 -4  4  3 -2  2  4 -3  3  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0
i: 9 15 14 10 13 10 -9  5 13-12 11-10  9  7 -6  5  4-12 12 12 11-10 10  9 -8  8  7 -6  6  5 -4  4  3 -2  2  4  3 -2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0  0
i: 8 15 14 14-13  7  8 -7  5 13-12 11  9 -8  7  5 -4  3  4-12 12 11-10 10  9 -8  8  7 -6  6  5 -4  4  3 -2  2 -3  3  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0  0
i: 7 10-14  9  8  9 -8  8 -7  5 12-11  5  9  7 -6  5  5 -4  3  6-11 11  5 -9  9  4 -7  7 -6  6  5 -4  4  3 -2  2  3 -2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0  0
i: 6 12 15 11 10 -9  9 -8  8 -9  9 12  7  6  5  7  6 -5  3  9  2 12  8-10 10  6 -5  5 -7  7  3 -5  5 -4  4  3 -2  2  3  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0  0
i: 5-14 13 10-12 10 -9  9  7 10 11 10  9  9 -8  5 -6  5 12 11-10 10 -9  9  8 -7  6 -8  8  5 -6  6  3  5 -4  4  3 -2  2 -2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0  0
i: 4 15 15-14 13-12 10  8-13 13 12-11 10  9  8 -7  5 13-12  3 11-11 10 10 -9  8 -9  9  7 -7  7  5  6 -5  3 -4  4  3 -2  2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0  0
i: 3-15 15 15-14 10 11  9 14 10 13 11-10  9 -8  8  7  6 13 13-12 12-11 11  9 -8  6 -9  8  8 -7  6 -6  5 -5  5  3 -3  3 -2  2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  0
i: 2 16-15 15 15 13 15-14 14 14-13 12 11-10  9  8 14-13  5-13  3  2 12-11 10  9 10  9 -8  8  8 -7  7  6  6  5 -4  4  3  3 -2  2 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0
i: 1-16 16-15 15-14 12 10 15 15 14 12-11 10 -9  9-14 14-14 14-13 13-12 12 11-10 10 -9  9  9 -8  8  7 -6  6 -5  5 -4  4 -3  3 -2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0
      1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75

Ответ:
1) 20
2) 34 38
3) 33